-- Create the database if it doesn't exist
CREATE DATABASE IF NOT EXISTS `chatroom`;

-- Use the chatroom database
USE `chatroom`;


DROP TABLE IF EXISTS `stanze`;
CREATE TABLE `stanze` (
  `codice` int NOT NULL AUTO_INCREMENT,
  `nome` varchar(255) NOT NULL,
  PRIMARY KEY (`codice`),
  UNIQUE KEY `nome` (`nome`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

DROP TABLE IF EXISTS `utenti`;

DROP TABLE IF EXISTS `utenti`;
CREATE TABLE `utenti` (
  `codice` int NOT NULL AUTO_INCREMENT,
  `nome_utente` varchar(255) NOT NULL,
  `email` varchar(255) NOT NULL,
  `password` varchar(255) NOT NULL,
  PRIMARY KEY (`codice`),
  UNIQUE KEY `nome_utente` (`nome_utente`),
  UNIQUE KEY `email` (`email`)) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


-- Table structure for table `messaggi`

DROP TABLE IF EXISTS `messaggi`;
CREATE TABLE `messaggi` (
  `id` int NOT NULL AUTO_INCREMENT,
  `stanza_codice` int NOT NULL,
  `utente_codice` int NOT NULL,
  `testo` text,
  `data_ora` timestamp NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),  
  FOREIGN KEY (`stanza_codice`) REFERENCES `stanze` (`codice`),
  FOREIGN KEY (`utente_codice`) REFERENCES `utenti` (`codice`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


